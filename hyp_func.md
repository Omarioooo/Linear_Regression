# 🎯 **ملخص عن t-test و p-value في الانحدار الخطي 📊**

---

## 🔹 **1️⃣ ما هو t-test؟ 🤔**

الـ **t-test** في الانحدار الخطي يُستخدم لاختبار ما إذا كان **معامل الانحدار (coefficient) 📈** مختلف إحصائيًا عن الصفر 🚫. بمعنى آخر: هل للمتغير المستقل تأثير حقيقي على المتغير التابع؟ 

> 💡 **ببساطة**: t-test يساعدنا نعرف إذا كان المتغير "مهم فعلاً" أم لا!

---

## 🔹 **2️⃣ طريقة حساب t-statistic �**

نحسب قيمة **t-statistic** لكل معامل باستخدام:

$$
t = \frac{\hat{\beta_i}}{SE(\hat{\beta_i})}
$$

- **$\hat{\beta_i}$** ➡️ معامل الانحدار (قيمة الـ coefficient) ✅  
- **$SE(\hat{\beta_i})$** ➡️ الخطأ المعياري (Standard Error) للمعامل ❗  

---

## 🔹 **3️⃣ كيف نحسب الخطأ المعياري (SE)؟ 🛠️**

$$
SE(\hat{\beta}) = \sqrt{MSE \cdot \text{diag}((X^TX)^{-1})}
$$

- **$MSE$** ➡️ متوسط مربعات الخطأ (Mean Squared Error) 📉  
- **$X^T X$** ➡️ مصفوفة ضرب `X` (المصفوفة الأصلية) في `X` المنقولة (Transpose) 🔄  
- **$\text{diag}$** ➡️ نأخذ القيم القطرية فقط (لحساب التباين لكل معامل) 🔢  

---

## 🔹 **4️⃣ درجة الحرية (Degrees of Freedom) 🎓**

تُحسب كالتالي:

$$
df = n - k - 1
$$

- **$n$** ➡️ عدد العينات (الصفوف في البيانات) 📊  
- **$k$** ➡️ عدد المتغيرات المستقلة (المدخلات) 🔢  

---

## 🔹 **5️⃣ كيف نحسب الـ p-value؟ 🧮**

نستخدم **التوزيع t (t-distribution)** لحساب الـ p-value:

$$
p = 2(1 - CDF(|t|))
$$

- **$CDF$** ➡️ دالة التوزيع التراكمي (Cumulative Distribution Function) 📈  
- **الضرب × 2** لأن الاختبار ثنائي الطرف (two-tailed test) ↔️  

---

## 🔹 **6️⃣ اتخاذ القرار: هل المتغير مهم؟ ⚖️**

| الشرط | القرار | التفسير |
|-------|--------|---------|
| **$p < \alpha$** ✅ | نرفض $H_0$ 🚫 | المتغير **مؤثر إحصائيًا** (يختلف عن الصفر) |
| **$p \geq \alpha$** ❌ | لا نرفض $H_0$ ⭕ | المتغير **غير مؤثر إحصائيًا** |

> **ملاحظة:** $\alpha$ هو مستوى الدلالة (عادةً 0.05 أو 5%) 🎯  

---

## 🔹 **7️⃣ مقارنة بين t-test و F-test ⚔️**

| المعيار | t-test 🧪 | F-test 🔥 |
|----------|----------|----------|
| **يختبر** | معامل واحد فقط | كل المعاملات معًا |
| **يستخدم** | t-statistic | F-statistic |
| **النتيجة** | هل المعامل ≠ 0؟ | هل النموذج كله مفيد؟ |

---

## 🔹 **8️⃣ كود Python للتنفيذ 🐍**

```python
# حساب t-statistic و p-value
import numpy as np
from scipy import stats

se = np.sqrt(np.diagonal(mse * np.linalg.inv(X.T @ X)))
t_stats = beta / se
df = n_sample - n_features - 1
p_values = [2 * (1 - stats.t.cdf(abs(t), df)) for t in t_stats]
```

---

## ✅ **الخلاصة النهائية 🏁**  

✔️ **t-test** يساعدنا نعرف إذا كان معامل الانحدار **مهم إحصائيًا** أم لا.  
✔️ نحسب **t-statistic** بقسمة المعامل على خطأه المعياري.  
✔️ **p-value** تحسب باستخدام **توزيع t**.  
✔️ إذا كانت **p-value < 0.05** ➡️ المعامل مهم! 🎉  

> **🎯 تذكر:** t-test للنموذج الخطي يشبه "الفحص الطبي" للمتغيرات! 🩺📊  


# 📘 فهم لماذا نأخذ الـ Diagonal فقط من مصفوفة التباين في الانحدار الخطي

## 🧠 الفكرة الأساسية: لماذا نهتم بالقطر (Diagonal) فقط؟

في تحليل الانحدار الخطي، نحتاج حساب **ثقة النموذج** في كل معامل على حدة. هذا يتم عبر:

1. **حساب الخطأ المعياري (SE)** لكل معامل انحدار β̂
2. **اختبار t-test** لكل معامل (هل يختلف معنويًا عن الصفر؟)

المفتاح هنا هو أننا نريد **تباين كل معامل بمفرده**، وهذا موجود على قطر مصفوفة التباين-التغاير:

$$
\text{Cov}(\hat{\beta}) = MSE \cdot (X^TX)^{-1}
$$

> 💡 **التفريق المهم**:
> - العناصر على القطر (Diagonal) → تباين كل معامل (نريدها)
> - العناصر الأخرى → تغاير بين معاملين (لا نحتاجها لاختبار المعامل الفردي)

---

## 🏗️ البناء الرياضي خطوة بخطوة

### 1️⃣ مصفوفة التباين-التغاير (Covariance Matrix)
تحتوي على:
- **التباين (Variance)** لكل معامل → على القطر الرئيسي
- **التغاير (Covariance)** بين كل زوج من المعاملات → خارج القطر

$$
\begin{bmatrix}
Var(\hat{\beta_0}) & Cov(\hat{\beta_0},\hat{\beta_1}) \\
Cov(\hat{\beta_1},\hat{\beta_0}) & Var(\hat{\beta_1})
\end{bmatrix}
$$

### 2️⃣ لماذا نأخذ القطر فقط؟
لأن اختبار t-test لكل معامل يعتمد فقط على:
- تباينه الخاص (على القطر) → لحساب SE
- لا يتأثر بالعلاقة مع المعاملات الأخرى

---

## 🧮 مثال عملي حسابي

### 🎯 البيانات:
| x | y |
|---|---|
| 1 | 2 |
| 2 | 3 |
| 3 | 5 |

### 1️⃣ تكوين المصفوفات
$$
X = 
\begin{bmatrix}
1 & 1 \\
1 & 2 \\
1 & 3
\end{bmatrix}, \quad
y = 
\begin{bmatrix}
2 \\
3 \\
5
\end{bmatrix}
$$

### 2️⃣ حساب معاملات الانحدار
$$
\hat{\beta} = (X^TX)^{-1}X^Ty
$$

### 3️⃣ حساب البواقي والـ MSE
$$
MSE = \frac{1}{n-k-1} \sum (y_i - \hat{y_i})^2
$$

### 4️⃣ مصفوفة التباين-التغاير
$$
\text{Cov}(\hat{\beta}) = MSE \cdot (X^TX)^{-1}
$$

### 5️⃣ استخراج التباينات الفردية
نأخذ العناصر القطرية فقط:
```python
var_beta0 = Cov_matrix[0,0]
var_beta1 = Cov_matrix[1,1]
```

### 6️⃣ حساب الخطأ المعياري
$$
SE = \sqrt{\text{Var}(\hat{\beta_i})}
$$

---

## 🔍 التوصيل النهائي لاختبار t

1. احسب t-statistic لكل معامل:
$$
t = \frac{\hat{\beta_i}}{SE(\hat{\beta_i})}
$$

2. احسب p-value باستخدام توزيع t:
```python
from scipy import stats
p_value = 2 * (1 - stats.t.cdf(abs(t), df=n-k-1))
```

---

## 💎 الخلاصة الذهبية

1. **القطر (Diagonal)** يحوي تباين كل معامل بمفرده ← هذا ما يهمنا في اختبار المعاملات الفردية
2. العناصر غير القطرية تمثل التغاير بين المعاملات ← مهمة لتحليل العلاقات بين المتغيرات ولكن ليس لاختبار t
3. العملية كلها تهدف لعمل:
   - ✅ تقدير دقة كل معامل (عبر SE)
   - ✅ تقييم الدلالة الإحصائية (عبر p-value)

> 🌟 **تشبيه**: مثل فحص دم لكل عضو على حدة (t-test) vs. فحص شامل للجسم (F-test)